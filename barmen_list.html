<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Бармен</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">

<style>
body{
    margin:0;
    font-family:'Inter',sans-serif;
    background:#0b0b0b;
    color:#fff;
}

.container{
    max-width:900px;
    margin:auto;
    padding:20px;
}

h1{
    text-align:center;
    margin-bottom:10px;
}

.total{
    text-align:center;
    font-size:18px;
    margin-bottom:25px;
    color:#7CFC00;
}

.card{
    background:#151515;
    border-radius:16px;
    padding:18px;
    margin-bottom:18px;
    border:1px solid #2a2a2a;
}

.name{
    font-size:22px;
    font-weight:600;
}

.cost{
    color:#7CFC00;
    margin-top:6px;
}

.ing{
    margin-top:14px;
    font-size:14px;
    line-height:1.6;
    color:#ccc;
}

.btns{
    display:flex;
    gap:10px;
    margin-top:14px;
}

button{
    background:#7CFC00;
    border:none;
    padding:10px 14px;
    border-radius:10px;
    font-weight:600;
    cursor:pointer;
}

.minus{
    background:#444;
    color:#fff;
}
</style>
</head>

<body>

<div class="container">

<h1>Панель бармена</h1>
<div class="total">Себестоимость вечера: <span id="sum">0</span> ₽</div>

<div id="list"></div>

</div>

<script>

const SHEET_ID="1CceZ3cIic_k9Z9GnXg_wOzoUGdYonzVkfypmSzf_ln8";
const url=`https://opensheet.elk.sh/${SHEET_ID}/БАР_КУХНЯ`;

let data=[];
let cocktails=[];
let total=0;

fetch(url)
.then(r=>r.json())
.then(rows=>{
    data=rows;
    parse();
    render();
});

function parse(){

    let current=null;

    data.forEach(r=>{

        if(r.ID_кокт){
            current={
                name:r.Название,
                cost:parseFloat(r.Себестоимость)||0,
                ings:[],
                count:0
            };
            cocktails.push(current);
        }

        if(current && r.Ингредиент){
            current.ings.push(
                `${r.Ингредиент} — ${r["Кол-во"]} ${r["Ед.изм"]}`
            );
        }

    });
}

function render(){

    const list=document.getElementById("list");
    list.innerHTML="";

    cocktails.forEach(c=>{

        let html=`
        <div class="card">
            <div class="name">${c.name}</div>
            <div class="cost">Себестоимость: ${c.cost} ₽</div>

            <div class="ing">${c.ings.join("<br>")}</div>

            <div class="btns">
                <button onclick="add('${c.name}')">+1</button>
                <button class="minus" onclick="remove('${c.name}')">-1</button>
                <div>Сделано: ${c.count}</div>
            </div>
        </div>
        `;

        list.innerHTML+=html;
    });

    document.getElementById("sum").innerText=total.toFixed(0);
}

function add(name){
    let c=cocktails.find(x=>x.name===name);
    c.count++;
    total+=c.cost;
    render();
}

function remove(name){
    let c=cocktails.find(x=>x.name===name);
    if(c.count>0){
        c.count--;
        total-=c.cost;
    }
    render();
}

</script>

</body>
</html>
