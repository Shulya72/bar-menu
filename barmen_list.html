<!DOCTYPE html>

<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Бармен</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">

<style>
body{
margin:0;
font-family:Inter;
background:#0b0b0b;
color:#fff;
}

.container{
max-width:800px;
margin:auto;
padding:20px;
}

.card{
background:#151515;
border-radius:18px;
padding:18px;
margin-bottom:14px;
}

.name{
font-size:20px;
font-weight:600;
}

.cost{
color:#7CFC00;
margin-top:4px;
}

.row{
display:flex;
gap:10px;
margin-top:12px;
}

input{
width:80px;
padding:10px;
border-radius:10px;
border:none;
background:#222;
color:#fff;
font-size:16px;
}

button{
padding:10px 16px;
border-radius:12px;
border:none;
background:#7CFC00;
font-weight:600;
}

.total{
margin-top:20px;
font-size:20px;
}
</style>

</head>

<body>

<div class="container">

<h2>Панель бармена</h2>

<div id="list"></div>

<div class="total">
Себестоимость вечера: <span id="sum">0</span> ₽
</div>

</div>

<script>

const SHEET_ID="1CceZ3cIic_k9Z9GnXg_wOzoUGdYonzVkfypmSzf_ln8";

const BAR_URL="https://opensheet.elk.sh/"+SHEET_ID+"/Бар_кухня";
const JOURNAL_URL="https://opensheet.elk.sh/"+SHEET_ID+"/ЖУРНАЛ";

let cocktails=[];

fetch(BAR_URL)
.then(r=>r.json())
.then(data=>{
cocktails=data;
render();
});

function render(){

const list=document.getElementById("list");
list.innerHTML="";

cocktails.forEach(row=>{

if(!row.ID) return;

list.innerHTML+=`
<div class="card">
<div class="name">${row.Коктейль}</div>
<div class="cost">Себестоимость: ${row["Себестоимость 1шт"]} ₽</div>

<div class="row">
<input id="q${row.ID}" type="number" value="1" min="1">
<button onclick="write('${row.ID}','${row.Коктейль}')">Списать</button>
</div>

</div>
`;
});
}

function write(id,name){

let qty=document.getElementById("q"+id).value;

let now=new Date().toLocaleDateString("ru-RU");

let row=[now,id,name,qty];

console.log("записать в журнал:",row);

// пока просто считаем сумму
addSum(id,qty);

}

function addSum(id,qty){

let cocktail=cocktails.find(c=>c.ID==id);
let cost=parseFloat(cocktail["Себестоимость 1шт"]||0);

let total=parseFloat(document.getElementById("sum").innerText||0);

total+=cost*qty;

document.getElementById("sum").innerText=total.toFixed(2);
}

</script>

</body>
</html>
